<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Class 8 Quiz App</title>
    <!-- PWA Configuration Links -->
    <link rel="manifest" href="./manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="https://placehold.co/192x192/4F46E5/ffffff?text=QZ">
    
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load React, ReactDOM, and Babel -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* Custom font and layout setup */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            overscroll-behavior-y: contain; /* Prevents pull-to-refresh on mobile */
        }
        #root {
            min-height: 100vh;
        }
    </style>
    
    <!-- PWA Manifest embedded for single-file deployment -->
    <script id="manifest-data" type="application/json">
    {
      "name": "Class 8 Quiz",
      "short_name": "C8 Quiz",
      "description": "Interactive quiz app for Class 8 students.",
      "start_url": ".",
      "display": "standalone",
      "background_color": "#ffffff",
      "theme_color": "#4F46E5",
      "icons": [
        {
          "src": "https://placehold.co/192x192/4F46E5/ffffff?text=QZ",
          "sizes": "192x192",
          "type": "image/png"
        },
        {
          "src": "https://placehold.co/512x512/4F46E5/ffffff?text=QZ",
          "sizes": "512x512",
          "type": "image/png"
        }
      ]
    }
    </script>
    <script>
        // Inject the manifest.json file dynamically because Netlify/GitHub Pages needs the file path
        // For a true single file solution, this is a workaround. 
        // NOTE: For best results on Netlify, you should still include a manifest.json file with the same content
        // alongside this index.html file. For the purpose of this single-file output, we emulate it.
        const manifestData = document.getElementById('manifest-data').textContent;
        const manifestBlob = new Blob([manifestData], {type: 'application/json'});
        const manifestUrl = URL.createObjectURL(manifestBlob);
        document.querySelector('link[rel="manifest"]').setAttribute('href', manifestUrl);
    </script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- ICON COMPONENTS (Simplified Inline SVGs) ---
        const Icon = ({ size = 20, className = '', children }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const Calculator = (props) => (
            <Icon {...props}><rect x="3" y="4" width="18" height="18" rx="2" ry="2" /><line x1="16" y1="2" x2="16" y2="6" /><line x1="8" y1="2" x2="8" y2="6" /><line x1="3" y1="10" x2="21" y2="10" /></Icon>
        );
        const Beaker = (props) => (
            <Icon {...props}><path d="M4.5 3L20 21.5" /><path d="M4.5 3L20 21.5" /><path d="M6 3l11 11" /><path d="M8 3l11 11" /><line x1="10" y1="5" x2="14" y2="9" /></Icon>
        );
        const Heart = (props) => (
            <Icon {...props}><path d="M19 14c1.49-1.49 1.49-3.41 0-4.9l-6.4-6.4c-1.49-1.49-3.91-1.49-5.4 0l-6.4 6.4c-1.49 1.49-1.49 3.91 0 5.4l6.4 6.4c1.49 1.49 3.91 1.49 5.4 0l6.4-6.4z" /></Icon>
        );
        const Globe = (props) => (
            <Icon {...props}><circle cx="12" cy="12" r="10" /><line x1="2" y1="12" x2="22" y2="12" /><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" /></Icon>
        );
        const BookOpen = (props) => (
            <Icon {...props}><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" /><path d="M6.5 2H20v20h-4.5a2.5 2.5 0 0 0-5 0H4V4.5A2.5 2.5 0 0 1 6.5 2z" /></Icon>
        );
        const Brain = (props) => (
            <Icon {...props}><path d="M12 2c2.76 0 5 2.24 5 5s-2.24 5-5 5-5-2.24-5-5 2.24-5 5-5z" /><path d="M12 12c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5z" /></Icon>
        );
        const Home = (props) => (
            <Icon {...props}><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" /><polyline points="9 22 9 12 15 12 15 22" /></Icon>
        );
        const BarChart3 = (props) => (
            <Icon {...props}><line x1="12" y1="20" x2="12" y2="10" /><line x1="18" y1="20" x2="18" y2="4" /><line x1="6" y1="20" x2="6" y2="16" /></Icon>
        );
        const Trophy = (props) => (
            <Icon {...props}><path d="M19 14c1.49 0 2-1.49 2-2s-.51-2-2-2h-1c-1.1 0-2 .9-2 2v2" /><path d="M5 14c-1.49 0-2-1.49-2-2s.51-2 2-2h1c1.1 0 2 .9 2 2v2" /><path d="M12 20v-2" /><path d="M12 18a7 7 0 0 0 7-7V6a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v5a7 7 0 0 0 7 7z" /></Icon>
        );
        const Clock = (props) => (
            <Icon {...props}><circle cx="12" cy="12" r="10" /><polyline points="12 6 12 12 16 14" /></Icon>
        );
        const CheckCircle = (props) => (
            <Icon {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" /><polyline points="22 4 12 14.01 9 11.01" /></Icon>
        );
        const XCircle = (props) => (
            <Icon {...props}><circle cx="12" cy="12" r="10" /><line x1="15" y1="9" x2="9" y2="15" /><line x1="9" y1="9" x2="15" y2="15" /></Icon>
        );
        const SkipForward = (props) => (
            <Icon {...props}><polygon points="5 4 15 12 5 20 5 4" /><line x1="19" y1="5" x2="19" y2="19" /></Icon>
        );
        const User = (props) => (
            <Icon {...props}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" /><circle cx="12" cy="7" r="4" /></Icon>
        );
        const LogOut = (props) => (
            <Icon {...props}><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" /><polyline points="16 17 21 12 16 7" /><line x1="21" y1="12" x2="9" y2="12" /></Icon>
        );
        const LogIn = (props) => (
            <Icon {...props}><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4" /><polyline points="10 17 15 12 10 7" /><line x1="15" y1="12" x2="3" y2="12" /></Icon>
        );
        const ChevronLeft = (props) => (
            <Icon {...props}><polyline points="15 18 9 12 15 6" /></Icon>
        );


        // --- QUIZ DATA STRUCTURE ---
        const quizData = {
    math: {
        name: "Mathematics",
        icon: "Calculator", // Assuming 'Calculator' is a component/variable reference
        color: "from-blue-500 to-blue-600",
        chapters: {
            algebra: {
                name: "Algebra",
                questions: [
                    { q: "What is the value of x in: 2x + 5 = 15?", options: ["5", "10", "7", "8"], correct: 0 },
                    { q: "Solve for y: 3y - 7 = 14", options: ["7", "5", "9", "6"], correct: 0 },
                    { q: "What is the coefficient of x in: 5x + 3?", options: ["5", "3", "8", "x"], correct: 0 },
                    { q: "Simplify: 2(x + 3) = ?", options: ["2x + 6", "2x + 3", "x + 6", "2x + 9"], correct: 0 },
                    { q: "If x = 4, what is 3x + 2?", options: ["14", "12", "10", "16"], correct: 0 },
                    { q: "What is x² when x = 5?", options: ["25", "10", "20", "15"], correct: 0 },
                    { q: "Solve: x/4 = 3", options: ["12", "7", "4", "16"], correct: 0 },
                    { q: "What is the value of 2x when x = 8?", options: ["16", "10", "18", "14"], correct: 0 },
                    { q: "Solve: 4x - 12 = 0", options: ["3", "4", "2", "1"], correct: 0 },
                    { q: "If 5x = 35, then x = ?", options: ["7", "5", "8", "6"], correct: 0 },
                    { q: "What is x in: x + 15 = 30?", options: ["15", "10", "20", "25"], correct: 0 }
                ]
            },
            geometry: {
                name: "Geometry",
                questions: [
                    { q: "Area of circle with radius 7 cm? (π = 22/7)", options: ["154 cm²", "144 cm²", "164 cm²", "174 cm²"], correct: 0 },
                    { q: "How many sides does a decagon have?", options: ["10", "8", "12", "9"], correct: 0 },
                    { q: "Sum of angles in a triangle?", options: ["180°", "360°", "90°", "270°"], correct: 0 },
                    { q: "Area of rectangle: length 8cm, width 5cm?", options: ["40 cm²", "13 cm²", "45 cm²", "35 cm²"], correct: 0 },
                    { q: "Perimeter of square with side 6cm?", options: ["24 cm", "36 cm", "18 cm", "12 cm"], correct: 0 },
                    { q: "How many faces does a cube have?", options: ["6", "8", "12", "4"], correct: 0 },
                    { q: "What is the diameter of a circle with radius 10cm?", options: ["20 cm", "10 cm", "30 cm", "5 cm"], correct: 0 },
                    { q: "Volume of cube with side 3cm?", options: ["27 cm³", "9 cm³", "12 cm³", "18 cm³"], correct: 0 },
                    { q: "Area of triangle: base 10cm, height 6cm?", options: ["30 cm²", "60 cm²", "16 cm²", "20 cm²"], correct: 0 },
                    { q: "How many edges does a cube have?", options: ["12", "8", "6", "10"], correct: 0 },
                    { q: "Circumference of circle with radius 7cm? (π=22/7)", options: ["44 cm", "154 cm", "28 cm", "88 cm"], correct: 0 }
                ]
            },
            numbers: {
                name: "Numbers & Operations",
                questions: [
                    { q: "What is the cube root of 729?", options: ["9", "8", "7", "6"], correct: 0 },
                    { q: "LCM of 12 and 18?", options: ["36", "24", "54", "72"], correct: 0 },
                    { q: "HCF of 24 and 36?", options: ["12", "6", "18", "24"], correct: 0 },
                    { q: "What is 15% of 200?", options: ["30", "25", "35", "40"], correct: 0 },
                    { q: "Square of 13?", options: ["169", "144", "196", "121"], correct: 0 },
                    { q: "What is $2^3 \\times 2^2$?", options: ["32", "16", "64", "8"], correct: 0 },
                    { q: "Convert 0.75 to fraction", options: ["3/4", "2/3", "4/5", "1/2"], correct: 0 },
                    { q: "What is 20% of 150?", options: ["30", "25", "35", "20"], correct: 0 },
                    { q: "Find the average of 10, 20, 30, 40", options: ["25", "20", "30", "15"], correct: 0 },
                    { q: "What is $3^4$?", options: ["81", "64", "27", "12"], correct: 0 },
                    { q: "Simplify: $48 \\div 6 + 2$", options: ["10", "8", "12", "6"], correct: 0 }
                ]
            }
        }
    },
    science: {
        name: "Science",
        icon: "Beaker", // Assuming 'Beaker' is a component/variable reference
        color: "from-green-500 to-green-600",
        chapters: {
            biology: {
                name: "Biology - Cell Structure",
                questions: [
                    { q: "What is the powerhouse of the cell?", options: ["Mitochondria", "Nucleus", "Ribosome", "Chloroplast"], correct: 0 },
                    { q: "Which organelle controls cell activities?", options: ["Nucleus", "Mitochondria", "Cell membrane", "Cytoplasm"], correct: 0 },
                    { q: "What gives plants their green color?", options: ["Chlorophyll", "Carotene", "Xanthophyll", "Anthocyanin"], correct: 0 },
                    { q: "Cell wall is found in?", options: ["Plants", "Animals", "Humans", "Bacteria only"], correct: 0 },
                    { q: "What is the basic unit of life?", options: ["Cell", "Tissue", "Organ", "Atom"], correct: 0 },
                    { q: "Which organelle helps in protein synthesis?", options: ["Ribosome", "Lysosome", "Vacuole", "Golgi body"], correct: 0 },
                    { q: "What is the jelly-like substance in cells?", options: ["Cytoplasm", "Nucleoplasm", "Protoplasm", "Plasma"], correct: 0 },
                    { q: "Lysosomes are known as?", options: ["Suicide bags", "Power house", "Control center", "Storage units"], correct: 0 }
                ]
            },
            chemistry: {
                name: "Chemistry - Elements & Compounds",
                questions: [
                    { q: "Chemical formula for water?", options: ["$H_2O$", "$CO_2$", "$NaCl$", "$O_2$"], correct: 0 },
                    { q: "Which gas do plants absorb?", options: ["Carbon Dioxide", "Oxygen", "Nitrogen", "Hydrogen"], correct: 0 },
                    { q: "Symbol for Gold?", options: ["Au", "Ag", "Fe", "Cu"], correct: 0 },
                    { q: "Common salt is?", options: ["NaCl", "KCl", "CaCl2", "MgCl2"], correct: 0 },
                    { q: "Atomic number of Carbon?", options: ["6", "12", "8", "14"], correct: 0 },
                    { q: "pH of pure water?", options: ["7", "0", "14", "10"], correct: 0 },
                    { q: "What is the symbol for Iron?", options: ["Fe", "Ir", "In", "I"], correct: 0 },
                    { q: "Which gas is needed for burning?", options: ["Oxygen", "Nitrogen", "Carbon dioxide", "Helium"], correct: 0 }
                ]
            },
            physics_intro: {
                name: "Physics - Force & Motion (Intro)",
                questions: [
                    { q: "Unit of force?", options: ["Newton", "Joule", "Watt", "Pascal"], correct: 0 },
                    { q: "Speed of light?", options: ["$3 \\times 10^8 m/s$", "$3 \\times 10^6 m/s$", "$3 \\times 10^7 m/s$", "$3 \\times 10^9 m/s$"], correct: 0 },
                    { q: "SI unit of pressure?", options: ["Pascal", "Newton", "Bar", "Atmosphere"], correct: 0 },
                    { q: "Formula for speed?", options: ["Distance/Time", "Time/Distance", "Distance x Time", "Force x Time"], correct: 0 },
                    { q: "Acceleration due to gravity?", options: ["$9.8 m/s^2$", "$10 m/s^2$", "$8.9 m/s^2$", "$9 m/s^2$"], correct: 0 },
                    { q: "1 Newton equals?", options: ["$1 kg \\cdot m/s^2$", "$1 kg \\cdot m$", "$1 kg/s^2$", "$1 m/s^2$"], correct: 0 },
                    { q: "What is inertia?", options: ["Resistance to motion", "Force applied", "Speed of object", "Mass of object"], correct: 0 },
                    { q: "Friction is a?", options: ["Contact force", "Non-contact force", "Magnetic force", "Gravitational force"], correct: 0 }
                ]
            },
            // --- NEWLY ADDED UNITS BELOW ---
            physics_velocity: {
                name: "Unit 2: Velocity and Acceleration",
                questions: [
                    { q: "Which of the following describes a body that is considered to be at rest?", options: ["A flying bird", "A running bus", "A walking man", "A tower"], correct: 3 },
                    { q: "A body is said to be in uniform motion if it moves with:", options: ["Variable speed", "Constant velocity", "Zero acceleration", "Increasing displacement"], correct: 1 },
                    { q: "What kind of motion does a body exhibit if its velocity is not constant?", options: ["Stationary motion", "Uniform motion", "Non-uniform motion", "Zero motion"], correct: 2 },
                    { q: "The average distance traveled by a body in a particular direction in one second is called:", options: ["Displacement", "Average speed", "Average velocity", "Acceleration"], correct: 2 },
                    { q: "Which formula is used to calculate the average velocity (vav) of a body?", options: ["vav = total time taken × total displacement", "vav = total displacement / total time taken", "vav = (final velocity - initial velocity) / 2", "vav = total distance / total time taken"], correct: 1 },
                    { q: "A car is displaced 20 m in 4 s and then 30 m in the next 6 s in the same direction. What is its average velocity?", options: ["4 m/s", "5 m/s", "10 m/s", "50 m/s"], correct: 1 },
                    { q: "The velocity of a body defined with respect to a reference point is called:", options: ["Absolute velocity", "Uniform velocity", "Relative velocity", "Average velocity"], correct: 2 },
                    { q: "Why is the state of rest or motion of a body considered a relative term?", options: ["It only depends on the body's mass", "It depends on the size of the body", "It depends on the state of the body with the reference objects", "It is always defined with respect to the sun"], correct: 2 },
                    { q: "Two cars, A and B, are moving with velocities 15 m/s and 10 m/s respectively, in the same direction. What is the relative velocity of car A with respect to car B?", options: ["25 m/s", "150 m/s", "5 m/s", "1.5 m/s"], correct: 2 },
                    { q: "If two cars are moving with velocities VA = 12 m/s and VB = 8 m/s in opposite directions, what is their relative velocity (VAB)?", options: ["4 m/s", "20 m/s", "96 m/s", "1.5 m/s"], correct: 1 },
                    { q: "What is the term for the rate of increase in velocity?", options: ["Retardation", "Uniform motion", "Acceleration", "Relative velocity"], correct: 2 },
                    { q: "What is the SI unit of acceleration?", options: ["m/s", "m/s²", "N", "kg/m³"], correct: 1 },
                    { q: "Retardation is also known as:", options: ["Positive acceleration", "Uniform velocity", "Negative acceleration", "Constant velocity"], correct: 2 },
                    { q: "When is the acceleration of a body zero?", options: ["When it starts from rest", "When it is in non-uniform motion", "When it has uniform velocity", "When it is thrown upwards"], correct: 2 },
                    { q: "A bus starts from rest (u=0 m/s) and attains a velocity of 10 m/s in 5 s. What is its acceleration (a)?", options: ["0.5 m/s²", "2 m/s²", "5 m/s²", "50 m/s²"], correct: 1 },
                    { q: "A car is traveling at 20 m/s. The driver applies the brake and the car stops (v=0 m/s) in 10 s. What is the retardation (a) of the car?", options: ["2 m/s²", "1 m/s²", "–2 m/s²", "–10 m/s²"], correct: 0 },
                    { q: "Which equation relates final velocity (v), initial velocity (u), acceleration (a), and time (t)?", options: ["v = u + at", "v² = u² + 2as", "s = ut + ½at²", "v = (u + a) / t"], correct: 0 },
                    { q: "A train increases its velocity from 10 m/s to 30 m/s over a time period of 5 s. What is the acceleration of the train?", options: ["2 m/s²", "4 m/s²", "5 m/s²", "8 m/s²"], correct: 1 },
                    { q: "A motorcycle starts from rest (u=0 m/s) with an acceleration of 0.5 m/s². What is its velocity (v) after 10 seconds?", options: ["0.5 m/s", "5 m/s", "10 m/s", "50 m/s"], correct: 1 },
                    { q: "Which of the following defines the concept of a reference point?", options: ["A point where acceleration is zero", "A fixed location used to define the relative velocity of an object", "The point where a body changes from uniform to non-uniform motion", "The midpoint between two moving objects"], correct: 1 }
                ]
            },
            physics_simple_machines: {
                name: "Unit 3: Simple Machine",
                questions: [
                    { q: "What is the primary function of a simple machine?", options: ["To increase the total amount of work done", "To do work easily, quickly, and with less effort", "To decrease the distance over which the effort is applied", "To eliminate friction entirely"], correct: 1 },
                    { q: "Which of the following is defined as the force applied to operate a simple machine?", options: ["Load (L)", "Effort (E)", "Fulcrum (F)", "Mechanical Advantage (MA)"], correct: 1 },
                    { q: "The ratio of the load to the effort on a balanced lever is called:", options: ["Velocity Ratio (VR)", "Efficiency (η)", "Mechanical Advantage (MA)", "Input Work"], correct: 2 },
                    { q: "What does a Mechanical Advantage (MA) of 2.5 signify for a simple machine?", options: ["The effort must move 2.5 times the load distance", "The machine can lift a load 2.5 times heavier than the applied effort", "The efficiency of the machine is 25%", "The effort applied is 2.5 times greater than the load"], correct: 1 },
                    { q: "Which factor causes the Mechanical Advantage (MA) of a simple machine to decrease?", options: ["Increase in load distance", "Decrease in effort applied", "Increase in friction", "Increase in Velocity Ratio (VR)"], correct: 2 },
                    { q: "The ratio of the distance moved by the effort to the distance moved by the load is called:", options: ["Mechanical Advantage (MA)", "Efficiency (η)", "Work Ratio", "Velocity Ratio (VR)"], correct: 3 },
                    { q: "How is the Velocity Ratio (VR) of a simple machine affected by friction?", options: ["VR increases due to friction", "VR decreases due to friction", "Friction has no effect on VR", "VR is equal to the mechanical advantage when friction is present"], correct: 2 },
                    { q: "What is the work done by the machine when effort is applied?", options: ["Input Work", "Output Work", "Net Work", "Waste Work"], correct: 1 },
                    { q: "The ratio of output work to input work in a machine, expressed as a percentage, is called:", options: ["Mechanical Advantage", "Velocity Ratio", "Efficiency", "Work Multiplier"], correct: 2 },
                    { q: "Due to friction, the Mechanical Advantage (MA) of any real machine is always:", options: ["Equal to the Velocity Ratio (VR)", "Greater than the Velocity Ratio (VR)", "Less than the Velocity Ratio (VR)", "Independent of the Velocity Ratio (VR)"], correct: 2 },
                    { q: "An effort of 50 N is applied to lift a load of 200 N using a lever. What is the Mechanical Advantage (MA) of the lever?", options: ["0.25", "4", "250", "100"], correct: 1 },
                    { q: "If the effort is displaced 5 m and the load is lifted 1 m, what is the Velocity Ratio (VR) of the machine?", options: ["0.2", "1", "5", "6"], correct: 2 },
                    { q: "A machine has an MA of 4 and a VR of 5. What is the efficiency (η) of the machine?", options: ["125%", "80%", "20%", "40%"], correct: 1 },
                    { q: "The work done on the machine when an effort is applied is called:", options: ["Useful work", "Output work", "Input work", "Effort work"], correct: 2 },
                    { q: "Work done on a machine is calculated using the formula:", options: ["Load × Load Distance", "Load ÷ Effort", "Effort × Effort Distance", "Effort ÷ Load Distance"], correct: 2 },
                    { q: "The efficiency of a simple machine can be represented by which of the following ratios?", options: ["(MA / VR) × 100%", "(Effort / Load) × 100%", "(VR / MA) × 100%", "(Load Distance / Effort Distance) × 100%"], correct: 0 },
                    { q: "If a load of 500 N is lifted using an effort of 200 N, the Mechanical Advantage (MA) is:", options: ["0.4", "2.5", "3", "5"], correct: 1 },
                    { q: "If the effort applied in a simple machine is magnified (i.e., the load lifted is greater than the effort), which distance must be true?", options: ["Effort distance must be equal to load distance", "Effort distance must be greater than load distance", "Effort distance must be less than load distance", "Effort distance must be zero"], correct: 1 },
                    { q: "A machine is 100% efficient. This implies:", options: ["MA < VR", "Input Work < Output Work", "MA = VR", "Friction is maximized"], correct: 2 },
                    { q: "Which part of the lever system is the weight of the object to be lifted?", options: ["Effort (E)", "Fulcrum (F)", "Load (L)", "Effort Distance"], correct: 2 }
                ]
            },
            physics_pressure: {
                name: "Unit 4: Pressure",
                questions: [
                    { q: "What is defined as the force acting perpendicularly on a unit area of a body?", options: ["Thrust", "Weight", "Pressure", "Force"], correct: 2 },
                    { q: "What is the total force exerted by a body on a surface called?", options: ["Pressure", "Thrust", "Weight", "Density"], correct: 1 },
                    { q: "What is the SI unit of pressure?", options: ["Newton (N)", "Joule (J)", "Pascal (Pa)", "Watt (W)"], correct: 2 },
                    { q: "Which formula correctly represents the calculation of pressure?", options: ["Pressure = Area × Force", "Pressure = Force / Area", "Pressure = Area / Force", "Pressure = Force × Volume"], correct: 1 },
                    { q: "If the area on which a force is applied is increased, how does the resulting pressure change, assuming the force remains constant?", options: ["Pressure increases", "Pressure decreases", "Pressure remains the same", "Pressure first increases and then decreases"], correct: 1 },
                    { q: "Why does the edge of a knife become sharp?", options: ["To increase the force applied", "To increase the area and reduce the force", "To reduce the area and increase the pressure", "To reduce the friction"], correct: 2 },
                    { q: "A force of 100 N is applied over an area of 0.5 m². What is the pressure exerted?", options: ["50 Pa", "100 Pa", "200 Pa", "500 Pa"], correct: 2 },
                    { q: "Which scientist is the Pascal (Pa) unit of pressure named after?", options: ["Isaac Newton", "Evangelista Torricelli", "Blaise Pascal", "Archimedes"], correct: 2 },
                    { q: "What is the pressure exerted by a liquid known as?", options: ["Atmospheric pressure", "Lateral pressure", "Hydrostatic pressure", "Density pressure"], correct: 2 },
                    { q: "How does the liquid pressure at a point in a container change with the depth of the point?", options: ["It decreases with depth", "It is independent of depth", "It increases with depth", "It depends only on the shape of the container"], correct: 2 },
                    { q: "At the same depth in a stationary liquid, the pressure:", options: ["Is equal in all directions", "Is greater vertically", "Is greater horizontally", "Depends on the volume of the liquid"], correct: 0 },
                    { q: "Which instrument is used to measure the atmospheric pressure?", options: ["Hydrometer", "Barometer", "Spring balance", "Beam balance"], correct: 1 },
                    { q: "The atmospheric pressure at sea level is approximately equal to the pressure exerted by a column of mercury of what height?", options: ["76 cm of Hg", "76 m of Hg", "10 m of water", "1 mm of Hg"], correct: 0 },
                    { q: "What is defined as the force acting per unit area of the earth's surface due to the weight of the air column above it?", options: ["Liquid pressure", "Barometric pressure", "Thrust", "Atmospheric pressure"], correct: 3 },
                    { q: "As we move up a mountain to a higher altitude, the atmospheric pressure:", options: ["Increases, because the height of the air column above decreases", "Decreases, because the height of the air column above decreases", "Remains the same", "Decreases due to temperature rise"], correct: 1 },
                    { q: "The pressure exerted by a liquid column is given by P=hρg. What does the symbol ρ (rho) represent?", options: ["Height of the liquid", "Acceleration due to gravity", "Density of the liquid", "Volume of the liquid"], correct: 2 },
                    { q: "What is the principle that states that an external pressure applied to an enclosed liquid is transmitted equally in all directions throughout the liquid and to the walls of the container?", options: ["Archimedes' Principle", "Newton's Third Law", "Pascal's Law", "Bernoulli's Principle"], correct: 2 },
                    { q: "Hydraulic presses, hydraulic brakes, and hydraulic jacks all function based on which scientific principle?", options: ["Archimedes' Principle", "Pascal's Law", "Law of Conservation of Energy", "Newton's First Law"], correct: 1 },
                    { q: "A force of 50 N is applied to a piston with an area of 0.05 m² in a hydraulic system. What is the pressure transmitted throughout the liquid?", options: ["10 Pa", "100 Pa", "1,000 Pa", "2,500 Pa"], correct: 2 },
                    { q: "A force of 1 N acting on an area of 1 m² is defined as:", options: ["1 Newton", "1 Bar", "1 Pascal", "1 Joule"], correct: 2 }
                ]
            },
            physics_work_energy: {
                name: "Unit 5: Work, Energy and Power",
                questions: [
                    { q: "In Physics, work is said to be done only when:", options: ["Energy is transformed", "A force is applied and the body is displaced in the direction of the force", "The body is lifted to a height", "The body is in motion"], correct: 1 },
                    { q: "What is the SI unit of work?", options: ["Watt (W)", "Newton (N)", "Joule (J)", "Pascal (Pa)"], correct: 2 },
                    { q: "What is defined as the capacity of a body to do work?", options: ["Power", "Force", "Energy", "Momentum"], correct: 2 },
                    { q: "A raised foot before kicking a football possesses what type of energy due to the change in configuration?", options: ["Kinetic energy", "Chemical energy", "Potential energy", "Heat energy"], correct: 2 },
                    { q: "Which scenario represents a situation where no work is done according to the scientific definition?", options: ["A man pushing a wall that does not move", "A car accelerating on a flat road", "A person lifting a box vertically", "A body falling from a height"], correct: 0 },
                    { q: "One Joule (J) of work is done when a force of 1 N causes a displacement of:", options: ["1 m", "1 cm", "10 m", "1 kg"], correct: 0 },
                    { q: "The energy possessed by a body by virtue of its position or configuration is called:", options: ["Kinetic energy", "Potential energy", "Mechanical energy", "Chemical energy"], correct: 1 },
                    { q: "The energy possessed by a body by virtue of its motion is called:", options: ["Potential energy", "Heat energy", "Kinetic energy", "Sound energy"], correct: 2 },
                    { q: "What two factors does the kinetic energy of a moving body depend upon?", options: ["Volume and temperature", "Mass and velocity", "Time and acceleration", "Height and gravity"], correct: 1 },
                    { q: "What is the term for the rate of doing work?", options: ["Energy", "Force", "Power", "Momentum"], correct: 2 },
                    { q: "The SI unit of power is:", options: ["Joule (J)", "Newton-meter (N-m)", "Pascal (Pa)", "Watt (W)"], correct: 3 },
                    { q: "A person does 500 J of work in 5 seconds. What is the power consumed by the person?", options: ["10 W", "100 W", "2500 W", "5 W"], correct: 1 },
                    { q: "A stone of mass 5 kg is lifted up to a height of 3 m. Assuming g=9.8 m/s², what is the Potential Energy (PE) stored in the stone? (PE=mgh)", options: ["15 J", "147 J", "49 J", "150 J"], correct: 1 },
                    { q: "What is the work done by a man standing with a load of 25 kg at a height of 1 m from the ground?", options: ["24.5 J", "25 J", "0 J", "245 J"], correct: 2 },
                    { q: "Which formula correctly calculates Kinetic Energy (KE)?", options: ["KE = mgh", "KE = Force × Distance", "KE = ½mv²", "KE = Power × Time"], correct: 2 },
                    { q: "The transformation of one form of energy into another form is called:", options: ["Law of Conservation of Energy", "Energy conversion", "Transformation of energy", "Energy dissipation"], correct: 2 },
                    { q: "Which device converts Chemical Energy into Electric Energy?", options: ["Generator", "Electric Motor", "Cell/Battery", "Electric Fan"], correct: 2 },
                    { q: "The energy transformation in a torch light (flashlight) is:", options: ["Electric energy → Light energy", "Chemical energy → Light energy", "Chemical energy → Electric energy → Light energy", "Light energy → Electric energy"], correct: 2 },
                    { q: "What is meant by a machine having 100 W power?", options: ["It can do 100 J of work", "It can work faster", "It can do 100 J of work in 1 second", "It has a high Mechanical Advantage"], correct: 2 },
                    { q: "Which of the following is an example of a body possessing energy due to its motion?", options: ["Water stored in a dam", "A stretched rubber", "A bullet fired from the gun", "A stone at the top of a slide"], correct: 2 }
                ]
            },
            physics_heat: {
                name: "Unit 6: Heat",
                questions: [
                    { q: "What is defined as the form of energy that produces the sensation of hotness or coldness in the body?", options: ["Temperature", "Heat", "Work", "Radiation"], correct: 1 },
                    { q: "What is the SI unit of heat?", options: ["Celsius (°C)", "Joule (J)", "Kelvin (K)", "Calorie (cal)"], correct: 1 },
                    { q: "What is defined as the degree of hotness or coldness of a body?", options: ["Heat", "Energy", "Temperature", "Specific heat capacity"], correct: 2 },
                    { q: "The SI unit of temperature is:", options: ["Degree Celsius (°C)", "Degree Fahrenheit (°F)", "Kelvin (K)", "Calorie (cal)"], correct: 2 },
                    { q: "Heat always flows from a body at:", options: ["Low temperature to a body at high temperature", "High heat content to low heat content", "High temperature to a body at low temperature", "Higher density to lower density"], correct: 2 },
                    { q: "What instrument is used to measure the temperature of a body?", options: ["Barometer", "Hydrometer", "Calorimeter", "Thermometer"], correct: 3 },
                    { q: "Which two fixed points are used to graduate a thermometer scale?", options: ["Boiling point of water and freezing point of alcohol", "Boiling point of mercury and freezing point of water", "Boiling point of water and freezing point of water", "Room temperature and body temperature"], correct: 2 },
                    { q: "What is the upper fixed point and lower fixed point of the Celsius scale at standard pressure?", options: ["100°C and 0°C", "212°C and 32°C", "373 K and 273 K", "100°C and –40°C"], correct: 0 },
                    { q: "Convert 50°C to the Fahrenheit scale using the formula C/5 = (F-32)/9.", options: ["10°F", "90°F", "122°F", "160°F"], correct: 2 },
                    { q: "What is the value of 0°C on the Kelvin scale?", options: ["100 K", "273 K", "373 K", "0 K"], correct: 1 },
                    { q: "The process of heat transfer in which heat travels through a solid from the hot end to the cold end without the actual movement of particles is called:", options: ["Convection", "Radiation", "Conduction", "Thermal expansion"], correct: 2 },
                    { q: "Which method of heat transfer is dominant in gases and liquids, involving the actual movement of heated fluid particles?", options: ["Conduction", "Convection", "Radiation", "Insulation"], correct: 1 },
                    { q: "Heat from the Sun reaches the Earth through the vacuum of space primarily by which process?", options: ["Conduction", "Convection", "Radiation", "Absorption"], correct: 2 },
                    { q: "Materials that allow heat to pass through them easily are called:", options: ["Insulators", "Non-metals", "Conductors", "Radiators"], correct: 2 },
                    { q: "In which type of material is heat transfer mainly by the process of conduction?", options: ["Liquids", "Gases", "Solids", "Vacuum"], correct: 2 },
                    { q: "Land breeze and sea breeze are examples of natural phenomena that occur due to the heat transfer process of:", options: ["Conduction", "Convection", "Radiation", "Reflection"], correct: 1 },
                    { q: "What are materials called that do not allow heat to pass through them easily?", options: ["Metals", "Conductors", "Insulators", "Semi-conductors"], correct: 2 },
                    { q: "Which process of heat transfer does not require any medium?", options: ["Conduction", "Convection", "Radiation", "Both Conduction and Convection"], correct: 2 },
                    { q: "If a body's temperature is 30°C, what is its equivalent temperature on the Kelvin scale?", options: ["30 K", "303 K", "243 K", "300 K"], correct: 1 },
                    { q: "Which is the clinical thermometer designed to measure?", options: ["Temperature of water", "Temperature of food", "Human body temperature", "Boiling point of water"], correct: 2 }
                ]
            }
        }
    },
    health: {
        name: "Health & PE",
        icon: "Heart", // Assuming 'Heart' is a component/variable reference
        color: "from-red-500 to-red-600",
        chapters: {
            humanbody: {
                name: "Human Body Organization",
                questions: [
                    { q: "What is considered the basic unit of life in the human body?", options: ["Organ", "Tissue", "Cell", "Organ System"], correct: 2 },
                    { q: "The human body is described as a multicellular organism. What does 'multicellular' primarily mean?", options: ["Having only one cell", "Having many different colors", "Having many cells", "Having many systems"], correct: 2 },
                    { q: "In the hierarchy of organization, what level comes directly after cells?", options: ["Organ systems", "Organs", "Homeostasis", "Tissues"], correct: 3 },
                    { q: "A collection of similar tissues working together forms what level of organization?", options: ["A cell", "An organ", "An external world", "A basic unit"], correct: 1 },
                    { q: "What is the highest level of structural organization mentioned, which is made up of a collection of organs?", options: ["Organ systems", "Tissues", "Homeostasis", "Multicellular"], correct: 0 },
                    { q: "The arrangement of structures from cells to tissues to organs and organ systems is called a remarkable:", options: ["Simple structure", "Complex structure", "Random structure", "Single structure"], correct: 1 }
                ]
            }
        }
    }
};
        // Main App Component
        function App() {
            const { useState, useEffect } = React;
            
            // --- AUTHENTICATION & PERSISTENCE STATE ---
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [currentUser, setCurrentUser] = useState(null);
            const [users, setUsers] = useState({});
            const [loginForm, setLoginForm] = useState({ username: '', password: '' });
            const [isSignup, setIsSignup] = useState(false);
            const [loginError, setLoginError] = useState('');

            // --- QUIZ STATE ---
            const [screen, setScreen] = useState('home');
            const [selectedSubject, setSelectedSubject] = useState(null);
            const [selectedChapter, setSelectedChapter] = useState(null);
            const [currentQuestion, setCurrentQuestion] = useState(0);
            const [score, setScore] = useState(0);
            const [selectedAnswer, setSelectedAnswer] = useState(null);
            const [showFeedback, setShowFeedback] = useState(false);
            const [skippedQuestions, setSkippedQuestions] = useState([]);
            const [answeredQuestions, setAnsweredQuestions] = useState([]);
            const [progress, setProgress] = useState({});
            const [timeSpent, setTimeSpent] = useState(0);
            const [quizStartTime, setQuizStartTime] = useState(null);
            const [quizQuestions, setQuizQuestions] = useState([]);

            // Load users and check login on mount
            useEffect(() => {
                try {
                    const savedUsers = localStorage.getItem('quizAppUsers');
                    if (savedUsers) {
                        setUsers(JSON.parse(savedUsers));
                    }
                    
                    const savedLogin = localStorage.getItem('quizAppCurrentUser');
                    if (savedLogin) {
                        const user = JSON.parse(savedLogin);
                        setCurrentUser(user);
                        setIsLoggedIn(true);
                        // Load user's progress
                        const userProgress = localStorage.getItem(`quizAppProgress_${user.username}`);
                        if (userProgress) {
                            setProgress(JSON.parse(userProgress));
                        }
                    }
                } catch (error) {
                    console.error('Error loading user data:', error);
                }
            }, []);

            // Save progress whenever it changes
            useEffect(() => {
                if (currentUser && isLoggedIn && Object.keys(progress).length > 0) {
                    try {
                        localStorage.setItem(`quizAppProgress_${currentUser.username}`, JSON.stringify(progress));
                    } catch (error) {
                        console.error('Error saving progress:', error);
                    }
                }
            }, [progress, currentUser, isLoggedIn]);

            // Timer effect
            useEffect(() => {
                let interval;
                if (screen === 'quiz' && quizStartTime) {
                    interval = setInterval(() => {
                        setTimeSpent(Math.floor((Date.now() - quizStartTime) / 1000));
                    }, 1000);
                }
                return () => clearInterval(interval);
            }, [screen, quizStartTime]);

            // --- AUTH HANDLERS ---
            const handleLogin = (e) => {
                e.preventDefault();
                setLoginError('');

                const username = loginForm.username.trim();
                const password = loginForm.password.trim();

                if (!username || !password) {
                    setLoginError('Please enter both username and password');
                    return;
                }

                if (isSignup) {
                    // Sign up
                    if (users[username]) {
                        setLoginError('Username already exists');
                        return;
                    }
                    if (username.length < 3) {
                        setLoginError('Username must be at least 3 characters');
                        return;
                    }
                    if (password.length < 4) {
                        setLoginError('Password must be at least 4 characters');
                        return;
                    }

                    try {
                        const newUsers = {
                            ...users,
                            [username]: { password: password }
                        };
                        setUsers(newUsers);
                        localStorage.setItem('quizAppUsers', JSON.stringify(newUsers));

                        const user = { username: username };
                        setCurrentUser(user);
                        setIsLoggedIn(true);
                        localStorage.setItem('quizAppCurrentUser', JSON.stringify(user));
                        setLoginForm({ username: '', password: '' });
                        setProgress({});
                        setScreen('home');
                    } catch (error) {
                        setLoginError('Error creating account. Please try again.');
                        console.error('Signup error:', error);
                    }
                } else {
                    // Login
                    if (!users[username]) {
                        setLoginError('Username not found');
                        return;
                    }
                    if (users[username].password !== password) {
                        setLoginError('Incorrect password');
                        return;
                    }

                    try {
                        const user = { username: username };
                        setCurrentUser(user);
                        setIsLoggedIn(true);
                        localStorage.setItem('quizAppCurrentUser', JSON.stringify(user));
                        
                        // Load user's progress
                        const userProgress = localStorage.getItem(`quizAppProgress_${username}`);
                        if (userProgress) {
                            setProgress(JSON.parse(userProgress));
                        } else {
                            setProgress({});
                        }
                        
                        setLoginForm({ username: '', password: '' });
                        setScreen('home');
                    } catch (error) {
                        setLoginError('Error logging in. Please try again.');
                        console.error('Login error:', error);
                    }
                }
            };

            const handleLogout = () => {
                try {
                    setIsLoggedIn(false);
                    setCurrentUser(null);
                    setProgress({});
                    localStorage.removeItem('quizAppCurrentUser');
                    setScreen('home');
                    setLoginForm({ username: '', password: '' });
                    setLoginError('');
                } catch (error) {
                    console.error('Logout error:', error);
                }
            };

            // --- QUIZ HANDLERS ---

            const startQuiz = (subjectKey, chapterKey) => {
                setSelectedSubject(subjectKey);
                setSelectedChapter(chapterKey);
                
                const questions = quizData[subjectKey].chapters[chapterKey].questions;
                setQuizQuestions(questions);

                setCurrentQuestion(0);
                setScore(0);
                setSelectedAnswer(null);
                setShowFeedback(false);
                setSkippedQuestions([]);
                setAnsweredQuestions([]);
                setTimeSpent(0);
                setQuizStartTime(Date.now());
                setScreen('quiz');
            };

            const handleAnswer = (index) => {
                if (showFeedback) return;
                
                setSelectedAnswer(index);
                setShowFeedback(true);
                
                const currentQ = quizQuestions[currentQuestion];
                const isCorrect = index === currentQ.correct;
                
                if (isCorrect) {
                    setScore(score + 1);
                }
                
                setAnsweredQuestions([...answeredQuestions, {
                    questionIndex: currentQuestion,
                    correct: isCorrect,
                    selectedOption: index
                }]);
            };

            const skipQuestion = () => {
                if (showFeedback) return; // Prevent skipping twice quickly
                setSkippedQuestions([...skippedQuestions, currentQuestion]);
                setAnsweredQuestions([...answeredQuestions, {
                    questionIndex: currentQuestion,
                    correct: false, // Mark skipped as incorrect for progress tracking
                    selectedOption: -1 // -1 indicates skipped
                }]);
                nextQuestion();
            };

            const nextQuestion = () => {
                const totalQuestions = quizQuestions.length;
                
                if (currentQuestion < totalQuestions - 1) {
                    setCurrentQuestion(currentQuestion + 1);
                    setSelectedAnswer(null);
                    setShowFeedback(false);
                } else {
                    updateProgress();
                    setScreen('result');
                }
            };

            const updateProgress = () => {
                if (!selectedSubject || !selectedChapter) return;

                const key = `${selectedSubject}-${selectedChapter}`;
                const totalQuestions = quizQuestions.length;
                const percentage = (score / totalQuestions) * 100;
                
                const currentData = progress[key] || {
                    score: 0,
                    total: totalQuestions,
                    percentage: 0,
                    timestamp: new Date().toLocaleDateString()
                };

                // Only update if the new score is better
                if (percentage > currentData.percentage) {
                     setProgress({
                        ...progress,
                        [key]: {
                            score,
                            total: totalQuestions,
                            percentage: parseFloat(percentage.toFixed(2)),
                            timestamp: new Date().toLocaleDateString()
                        }
                    });
                }
            };

            const formatTime = (seconds) => {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins}:${secs.toString().padStart(2, '0')}`;
            };

            const navigateToSubject = (subjectKey) => {
                setSelectedSubject(subjectKey);
                setSelectedChapter(null);
                setScreen('subject');
            };

            const restartQuiz = () => {
                setScreen('home');
                setSelectedSubject(null);
                setSelectedChapter(null);
                setCurrentQuestion(0);
                setScore(0);
                setSelectedAnswer(null);
                setShowFeedback(false);
                setSkippedQuestions([]);
                setAnsweredQuestions([]);
                setTimeSpent(0);
                setQuizStartTime(null);
                setQuizQuestions([]);
            };

            // --- RENDER SCREENS ---

            // 1. Login/Signup Screen
            if (!isLoggedIn) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-100 via-purple-50 to-pink-100 flex items-center justify-center p-4 font-sans">
                        <div className="max-w-md w-full bg-white rounded-2xl shadow-xl p-8 transform hover:scale-[1.01] transition-all duration-300">
                            <div className="text-center mb-8">
                                <div className="bg-gradient-to-r from-indigo-500 to-purple-500 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
                                    <BookOpen size={40} className="text-white" />
                                </div>
                                <h1 className="text-3xl font-bold text-gray-800 mb-2">Class 8 Quiz App</h1>
                                <p className="text-gray-600">
                                    {isSignup ? 'Create your account to start learning' : 'Login to continue your learning journey'}
                                </p>
                            </div>

                            <form onSubmit={handleLogin} className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Username</label>
                                    <input
                                        type="text"
                                        value={loginForm.username}
                                        onChange={(e) => setLoginForm({...loginForm, username: e.target.value})}
                                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 focus:outline-none transition-all"
                                        placeholder="Enter username"
                                        required
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Password</label>
                                    <input
                                        type="password"
                                        value={loginForm.password}
                                        onChange={(e) => setLoginForm({...loginForm, password: e.target.value})}
                                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 focus:outline-none transition-all"
                                        placeholder="Enter password"
                                        required
                                    />
                                </div>

                                {loginError && (
                                    <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-xl text-sm">
                                        {loginError}
                                    </div>
                                )}

                                <button
                                    type="submit"
                                    className="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 rounded-xl font-semibold hover:from-indigo-700 hover:to-purple-700 shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center gap-2"
                                >
                                    <LogIn size={20} />
                                    {isSignup ? 'Sign Up' : 'Login'}
                                </button>
                            </form>

                            <div className="mt-6 text-center">
                                <button
                                    onClick={() => {
                                        setIsSignup(!isSignup);
                                        setLoginError('');
                                        setLoginForm({ username: '', password: '' });
                                    }}
                                    className="text-indigo-600 hover:text-indigo-800 font-medium text-sm transition-colors"
                                >
                                    {isSignup ? 'Already have an account? Login' : "Don't have an account? Sign Up"}
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // --- HOME SCREEN ---
            if (screen === 'home') {
                const totalChapters = Object.values(quizData).reduce((acc, subj) => acc + Object.keys(subj.chapters).length, 0);
                const completedChapters = Object.keys(progress).length;
                const overallProgress = totalChapters > 0 ? (completedChapters / totalChapters) * 100 : 0;
                
                const SubjectCard = ({ subjectKey, subject }) => {
                    const chapterKeys = Object.keys(subject.chapters);
                    const total = chapterKeys.length;
                    const completed = chapterKeys.filter(chapKey => progress[`${subjectKey}-${chapKey}`]).length;
                    const percentage = total > 0 ? (completed / total) * 100 : 0;
                    const Icon = subject.icon;

                    return (
                        <div 
                            onClick={() => navigateToSubject(subjectKey)}
                            className={`group cursor-pointer bg-white rounded-xl shadow-lg p-6 flex flex-col items-start space-y-4 hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1 border-t-4 border-indigo-500`}
                        >
                            <div className={`p-4 rounded-full bg-gradient-to-r ${subject.color} text-white shadow-md group-hover:scale-105 transition-transform`}>
                                <Icon size={32} />
                            </div>
                            <h2 className="text-xl font-bold text-gray-800">{subject.name}</h2>
                            <p className="text-sm text-gray-500">{total} Chapters Available</p>
                            
                            <div className="w-full">
                                <div className="flex justify-between text-xs font-semibold mb-1">
                                    <span className="text-gray-600">Progress</span>
                                    <span className="text-indigo-600">{percentage.toFixed(0)}%</span>
                                </div>
                                <div className="w-full bg-gray-200 rounded-full h-2.5">
                                    <div 
                                        className={`h-2.5 rounded-full bg-gradient-to-r ${subject.color}`} 
                                        style={{ width: `${percentage}%` }}
                                    ></div>
                                </div>
                                <p className="text-xs text-gray-400 mt-1">{completed} / {total} Completed</p>
                            </div>
                        </div>
                    );
                };

                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-100 via-purple-50 to-pink-100 p-4 font-sans">
                        <div className="max-w-6xl mx-auto">
                            {/* User Header */}
                            <div className="bg-white rounded-xl shadow-lg p-4 mb-6 mt-4 flex items-center justify-between sticky top-4 z-10">
                                <div className="flex items-center gap-3">
                                    <div className="bg-indigo-100 p-3 rounded-full">
                                        <User size={24} className="text-indigo-600" />
                                    </div>
                                    <div>
                                        <p className="text-sm text-gray-600">Welcome back,</p>
                                        <p className="text-lg font-bold text-gray-800 capitalize">{currentUser?.username}</p>
                                    </div>
                                </div>
                                <button
                                    onClick={handleLogout}
                                    className="flex items-center gap-2 px-4 py-2 bg-red-100 text-red-600 rounded-lg font-medium hover:bg-red-200 transition-all text-sm shadow-md hover:shadow-lg"
                                >
                                    <LogOut size={18} />
                                    Logout
                                </button>
                            </div>

                            {/* Overall Progress Widget */}
                            <div className="bg-white rounded-xl shadow-xl p-6 mb-8 border-l-4 border-purple-500">
                                <div className="flex items-center justify-between mb-4">
                                    <h2 className="text-2xl font-extrabold text-gray-800 flex items-center gap-2">
                                        <BarChart3 size={24} className="text-purple-500" />
                                        Your Learning Dashboard
                                    </h2>
                                    <span className="text-3xl font-bold text-purple-600">{overallProgress.toFixed(0)}%</span>
                                </div>
                                <div className="w-full bg-purple-200 rounded-full h-3">
                                    <div 
                                        className="h-3 rounded-full bg-gradient-to-r from-indigo-500 to-purple-500 shadow-inner" 
                                        style={{ width: `${overallProgress}%` }}
                                    ></div>
                                </div>
                                <p className="text-sm text-gray-500 mt-2">
                                    {completedChapters} of {totalChapters} chapters attempted. Keep up the great work!
                                </p>
                            </div>

                            {/* Subject Grid */}
                            <h2 className="text-3xl font-bold text-gray-800 mb-6 border-b pb-2">Select a Subject</h2>
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                {Object.entries(quizData).map(([key, subject]) => (
                                    <SubjectCard key={key} subjectKey={key} subject={subject} />
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            // --- SUBJECT SCREEN (Chapter Selection) ---
            if (screen === 'subject') {
                if (!selectedSubject) {
                    setScreen('home');
                    return null;
                }
                
                const subject = quizData[selectedSubject];
                const Icon = subject.icon;
                
                const ChapterCard = ({ chapterKey, chapter }) => {
                    const key = `${selectedSubject}-${chapterKey}`;
                    const chapProgress = progress[key];
                    const percentage = chapProgress ? chapProgress.percentage : 0;

                    return (
                        <div 
                            onClick={() => startQuiz(selectedSubject, chapterKey)}
                            className="cursor-pointer bg-white rounded-xl shadow-md p-5 flex items-center justify-between hover:bg-indigo-50 transition-all duration-200 border-l-4 border-indigo-400"
                        >
                            <div>
                                <h3 className="text-lg font-semibold text-gray-800">{chapter.name}</h3>
                                <p className="text-sm text-gray-500">{chapter.questions.length} Questions</p>
                            </div>
                            <div className="text-right">
                                <span className={`inline-block px-3 py-1 text-xs font-bold rounded-full ${
                                    percentage === 100 ? 'bg-green-100 text-green-700' :
                                    percentage > 0 ? 'bg-yellow-100 text-yellow-700' : 'bg-gray-100 text-gray-500'
                                }`}>
                                    {percentage.toFixed(0)}% Mastered
                                </span>
                                {chapProgress && (
                                     <p className="text-xs text-gray-400 mt-1">Best Score: {chapProgress.score}/{chapProgress.total}</p>
                                )}
                            </div>
                            <button className="p-2 bg-indigo-100 text-indigo-600 rounded-full group-hover:bg-indigo-600 group-hover:text-white transition-colors">
                                <Trophy size={20} />
                            </button>
                        </div>
                    );
                };


                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-100 via-purple-50 to-pink-100 p-4 font-sans">
                        <div className="max-w-4xl mx-auto">
                            <button 
                                onClick={() => setScreen('home')}
                                className="flex items-center gap-1 text-indigo-600 hover:text-indigo-800 mb-6 font-medium transition-colors"
                            >
                                <ChevronLeft size={20} /> Back to Subjects
                            </button>

                            <div className={`bg-gradient-to-r ${subject.color} text-white p-6 rounded-xl shadow-xl mb-8 flex items-center gap-4`}>
                                <Icon size={40} className="p-2 bg-white/20 rounded-xl" />
                                <div>
                                    <p className="text-sm opacity-80">Subject</p>
                                    <h1 className="text-3xl font-bold">{subject.name}</h1>
                                </div>
                            </div>

                            <h2 className="text-2xl font-bold text-gray-800 mb-4">Choose a Chapter to Start</h2>
                            <div className="space-y-4">
                                {Object.entries(subject.chapters).map(([key, chapter]) => (
                                    <ChapterCard key={key} chapterKey={key} chapter={chapter} />
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            // --- QUIZ SCREEN ---
            if (screen === 'quiz') {
                const currentQ = quizQuestions[currentQuestion];
                const totalQuestions = quizQuestions.length;
                const subject = quizData[selectedSubject];
                const chapter = subject.chapters[selectedChapter];

                const isLastQuestion = currentQuestion === totalQuestions - 1;

                if (!currentQ) return <p>Loading...</p>;

                const getOptionClassName = (index) => {
                    let className = "px-4 py-3 border border-gray-300 rounded-xl transition-all duration-200 cursor-pointer hover:bg-indigo-50 flex items-center justify-between text-left";
                    
                    if (selectedAnswer !== null) {
                        const isCorrect = index === currentQ.correct;
                        const isSelected = index === selectedAnswer;

                        if (showFeedback) {
                            if (isCorrect) {
                                className = "px-4 py-3 rounded-xl bg-green-100 border-green-500 ring-2 ring-green-500 text-green-800 font-semibold shadow-md flex items-center justify-between text-left pointer-events-none";
                            } else if (isSelected && !isCorrect) {
                                className = "px-4 py-3 rounded-xl bg-red-100 border-red-500 ring-2 ring-red-500 text-red-800 font-semibold shadow-md flex items-center justify-between text-left pointer-events-none";
                            } else if (index !== selectedAnswer) {
                                 className += " opacity-60 pointer-events-none";
                            }
                        }
                    } else {
                         className += " bg-white hover:bg-indigo-50";
                    }
                    return className;
                };

                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-100 via-purple-50 to-pink-100 p-4 font-sans">
                        <div className="max-w-3xl mx-auto">
                            <div className="bg-white rounded-xl shadow-xl p-6 mb-6">
                                
                                {/* Quiz Header & Timer */}
                                <div className="flex justify-between items-center mb-6 pb-4 border-b">
                                    <div>
                                        <h1 className="text-2xl font-bold text-gray-800">{chapter.name}</h1>
                                        <p className="text-sm text-gray-500">{subject.name} | Q. {currentQuestion + 1} of {totalQuestions}</p>
                                    </div>
                                    <div className="flex items-center gap-2 bg-yellow-100 text-yellow-800 px-4 py-2 rounded-full font-semibold shadow-md">
                                        <Clock size={20} />
                                        <span>{formatTime(timeSpent)}</span>
                                    </div>
                                </div>

                                {/* Question Progress Bar */}
                                <div className="mb-6">
                                    <div className="w-full bg-gray-200 rounded-full h-2">
                                        <div 
                                            className="h-2 rounded-full bg-indigo-500 transition-all duration-300"
                                            style={{ width: `${((currentQuestion + 1) / totalQuestions) * 100}%` }}
                                        ></div>
                                    </div>
                                </div>

                                {/* Question Content */}
                                <p className="text-xl font-medium text-gray-900 mb-6 bg-gray-50 p-4 rounded-lg shadow-inner">
                                   **Q{currentQuestion + 1}.** {currentQ.q}
                                </p>

                                {/* Options */}
                                <div className="space-y-3">
                                    {currentQ.options.map((option, index) => (
                                        <button
                                            key={index}
                                            onClick={() => handleAnswer(index)}
                                            disabled={showFeedback}
                                            className={`w-full ${getOptionClassName(index)}`}
                                        >
                                            <span className="font-mono text-lg mr-4">{String.fromCharCode(65 + index)}.</span>
                                            <span className="flex-grow">{option}</span>
                                            {showFeedback && (
                                                index === currentQ.correct ? (
                                                    <CheckCircle size={20} className="text-green-600" />
                                                ) : index === selectedAnswer ? (
                                                    <XCircle size={20} className="text-red-600" />
                                                ) : null
                                            )}
                                        </button>
                                    ))}
                                </div>
                                
                                {/* Navigation Buttons */}
                                <div className="mt-8 flex justify-between gap-4">
                                    {!showFeedback ? (
                                        <button
                                            onClick={skipQuestion}
                                            className="flex items-center gap-2 px-6 py-3 bg-yellow-500 text-white rounded-xl font-semibold hover:bg-yellow-600 transition-all shadow-md"
                                        >
                                            <SkipForward size={20} />
                                            Skip Question
                                        </button>
                                    ) : (
                                        <div className="p-3">
                                            {selectedAnswer === currentQ.correct ? (
                                                <span className="text-green-600 font-bold text-lg flex items-center gap-2">
                                                    <CheckCircle size={24}/> Correct Answer!
                                                </span>
                                            ) : (
                                                <span className="text-red-600 font-bold text-lg flex items-center gap-2">
                                                    <XCircle size={24}/> Incorrect. The correct option was {String.fromCharCode(65 + currentQ.correct)}.
                                                </span>
                                            )}
                                        </div>
                                    )}

                                    <button
                                        onClick={nextQuestion}
                                        disabled={!showFeedback}
                                        className={`flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all shadow-md ${
                                            showFeedback ? 'bg-indigo-600 text-white hover:bg-indigo-700' : 'bg-gray-300 text-gray-600 cursor-not-allowed'
                                        }`}
                                    >
                                        {isLastQuestion ? 'View Results' : 'Next Question'}
                                        <ChevronLeft size={20} className="transform rotate-180" />
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            // --- RESULT SCREEN ---
            if (screen === 'result') {
                const totalQuestions = quizQuestions.length;
                const subject = quizData[selectedSubject];
                const chapter = subject.chapters[selectedChapter];

                const correctCount = answeredQuestions.filter(a => a.correct).length;
                const skippedCount = skippedQuestions.length;
                const percentage = (correctCount / totalQuestions) * 100;
                const resultMessage = percentage === 100 ? 'Perfect Score!' : percentage >= 75 ? 'Excellent Work!' : percentage >= 50 ? 'Good Effort!' : 'Keep Practicing!';

                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-100 via-purple-50 to-pink-100 flex items-center justify-center p-4 font-sans">
                        <div className="max-w-xl w-full bg-white rounded-2xl shadow-2xl p-8 text-center transform scale-100 hover:scale-[1.01] transition-all duration-300">
                            <div className="mb-6">
                                <Trophy size={60} className={`mx-auto mb-3 ${
                                    percentage === 100 ? 'text-yellow-500' : percentage >= 75 ? 'text-green-500' : 'text-indigo-500'
                                }`} />
                                <h1 className="text-4xl font-extrabold text-gray-800 mb-2">{resultMessage}</h1>
                                <p className="text-xl text-gray-600">{subject.name}: {chapter.name}</p>
                            </div>

                            <div className="bg-indigo-50 p-6 rounded-xl mb-6">
                                <p className="text-5xl font-bold text-indigo-700 mb-4">{percentage.toFixed(0)}%</p>
                                <div className="grid grid-cols-3 gap-4 text-gray-700 font-medium">
                                    <div>
                                        <p className="text-2xl font-bold text-green-600">{correctCount}</p>
                                        <p className="text-sm">Correct</p>
                                    </div>
                                    <div>
                                        <p className="text-2xl font-bold text-red-600">{totalQuestions - correctCount - skippedCount}</p>
                                        <p className="text-sm">Incorrect</p>
                                    </div>
                                    <div>
                                        <p className="text-2xl font-bold text-yellow-600">{skippedCount}</p>
                                        <p className="text-sm">Skipped</p>
                                    </div>
                                </div>
                            </div>

                            <div className="text-gray-600 mb-8">
                                <p>Total Questions: <span className="font-semibold">{totalQuestions}</span></p>
                                <p>Time Taken: <span className="font-semibold">{formatTime(timeSpent)}</span></p>
                                <p>Total Score: <span className="font-semibold">{correctCount} / {totalQuestions}</span></p>
                            </div>

                            <div className="flex flex-col sm:flex-row gap-4 justify-center">
                                <button
                                    onClick={restartQuiz}
                                    className="flex items-center justify-center gap-2 px-6 py-3 bg-indigo-600 text-white rounded-xl font-semibold hover:bg-indigo-700 transition-all shadow-lg"
                                >
                                    <Home size={20} /> Go to Home
                                </button>
                                <button
                                    onClick={() => startQuiz(selectedSubject, selectedChapter)}
                                    className="flex items-center justify-center gap-2 px-6 py-3 bg-white border border-indigo-600 text-indigo-600 rounded-xl font-semibold hover:bg-indigo-50 transition-all shadow-lg"
                                >
                                    <BarChart3 size={20} /> Retry Chapter
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }
        }

        // Render the App component
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
    
    <!-- PWA Service Worker (Handles caching for offline use) -->
    <script>
        // Service Worker Script embedded as a string, then registered
        const serviceWorkerCode = `
            const CACHE_NAME = 'quiz-app-v1';
            const urlsToCache = [
                '/', 
                'index.html', 
                'https://cdn.tailwindcss.com',
                'https://unpkg.com/react@18/umd/react.development.js',
                'https://unpkg.com/react-dom@18/umd/react-dom.development.js',
                'https://unpkg.com/@babel/standalone/babel.min.js'
                // Note: Placeholder image URLs are often blocked or should be cached manually if needed.
            ];

            // Install event: Caches all necessary files
            self.addEventListener('install', event => {
                event.waitUntil(
                    caches.open(CACHE_NAME)
                        .then(cache => {
                            console.log('Opened cache');
                            return cache.addAll(urlsToCache).catch(err => {
                                console.error('Failed to cache resources:', err);
                            });
                        })
                );
            });

            // Activate event: Cleans up old caches
            self.addEventListener('activate', event => {
                const cacheWhitelist = [CACHE_NAME];
                event.waitUntil(
                    caches.keys().then(cacheNames => {
                        return Promise.all(
                            cacheNames.map(cacheName => {
                                if (cacheWhitelist.indexOf(cacheName) === -1) {
                                    return caches.delete(cacheName);
                                }
                            })
                        );
                    })
                );
            });

            // Fetch event: Serves content from cache first, then network (Cache-First strategy)
            self.addEventListener('fetch', event => {
                event.respondWith(
                    caches.match(event.request)
                        .then(response => {
                            // Cache hit - return response
                            if (response) {
                                return response;
                            }
                            // No cache hit - fetch from network
                            return fetch(event.request).catch(error => {
                                // Fallback for specific offline content if needed
                                console.log('Fetch failed; cache fallback.');
                            });
                        })
                );
            });
        `;

        // Registering the Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // Create a Blob from the service worker script string
                const swBlob = new Blob([serviceWorkerCode], { type: 'application/javascript' });
                const swUrl = URL.createObjectURL(swBlob);
                
                navigator.serviceWorker.register(swUrl)
                    .then(registration => {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed: ', error);
                    });
            });
        }
    </script>
</body>
</html>

